---
layout: post
title: Output sequences from a fasta formatted file that match a list of sequence
  IDs
categories:
- Bioinformatics Notebook
- Bioruby
- Ruby
tags: []
status: publish
type: post
published: true
meta:
  _publicize_pending: '1'
author: 
---
<p>You need <a title="bioruby" href="http://bioruby.org/" target="_blank">bioruby</a> for this one. Bioruby is quite easy to install on unix systems. I use Ubuntu...</p>

{% highlight ruby %}
#!/usr/bin/env ruby
require 'bio'
include Bio
usage = << USAGE
######################################################################
Usage: fasta_extracta.rb seqlist.txt fasta_infile.fasta
Output all sequences from file fasta_infile.fasta
with ids matching those in seqlist.txt file (one entry per line)
######################################################################
USAGE
if ARGV.size == 0
  print usage
	exit 1
end
id_file = ARGV[0]
seq_file = ARGV[1]
ids = Array.new
File.new(id_file, 'r').each { |line| ids &lt;&lt; line.chop }
File.open(id_file+'_fasta_extracted', 'w') do |file|
  Bio::FlatFile.auto(seq_file).each do |item|
    ids.each do |id|
      if item.definition =~ /#{id}/
        seq = Bio::FastaFormat.new('> '+item.definition+"\n"+item.data)
        file.puts seq
      end
    end
  end
end
{% endhighlight %}
