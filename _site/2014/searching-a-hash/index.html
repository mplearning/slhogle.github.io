<!DOCTYPE html> <html> <head> <meta charset="utf-8"> <meta name="apple-mobile-web-app-capable" content="yes"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <meta name="viewport" content="width=device-width, initial-scale=1"> <title> Searching a hash | Notes </title> <meta name="description" content=" Microbes + Biogeochemistry "> <meta name="keywords" content="Marine, microbial ecology, bacteria, biogeochemistry, ocean"> <meta name="HandheldFriendly" content="True"> <meta name="MobileOptimized" content="320"> <!-- Social: Facebook / Open Graph --> <meta property="og:type" content="article"> <meta property="article:author" content="Shane Hogle"> <meta property="article:section" content="bioinformatics_notebook"> <meta property="article:tag" content=""> <meta property="article:published_time" content="2014-02-18 07:32:18 -0500"> <meta property="og:url" content="//2014/searching-a-hash/"> <meta property="og:title" content=" Searching a hash | Notes "> <meta property="og:image" content="/"> <meta property="og:description" content=" Microbes + Biogeochemistry "> <meta property="og:site_name" content="Shane Hogle"> <meta property="og:locale" content="en_US"> <!-- Social: Twitter --> <meta name="twitter:card" content="summary_large_image"> <meta name="twitter:site" content="@Hslhogle"> <meta name="twitter:title" content=" Searching a hash | Notes "> <meta name="twitter:description" content=" Microbes + Biogeochemistry "> <meta name="twitter:image:src" content="/"> <!-- Social: Google+ / Schema.org --> <meta itemprop="name" content=" Searching a hash | Notes "> <meta itemprop="description" content=" Microbes + Biogeochemistry "> <meta itemprop="image" content="/"> <!-- rel prev and next --> <link rel="stylesheet" href="/assets/css/main.css"> <link rel="stylesheet" href="/assets/css/font-awesome.min.css"> <!-- Canonical link tag --> <link rel="canonical" href="//2014/searching-a-hash/"> <link rel="alternate" type="application/rss+xml" title="Notes" href="//feed.xml"> <script type="text/javascript"> var disqus_shortname = 'slhogle-site'; var _gaq = _gaq || []; _gaq.push(['_setAccount', 'UA-XXXXX-XX']); _gaq.push(['_trackPageview']); (function() { var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true; ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js'; var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s); })(); </script> </head> <body> <main class="wrapper"> <header class="site-header"> <nav class="nav"> <div class="container"> <h1 class="logo"><a href="/">Notes<span></span></a></h1> <ul class="navbar"> <li><a href="/about">about</a></li> <li><a href="/research">research</a></li> <li><a href="/publications">publications</a></li> <li><a href="/contact">contact</a></li> </ul> </div> </nav> </header> <article class="post container" itemscope itemtype="http://schema.org/BlogPosting"> <header class="post-header"> <p class="post-meta"><time datetime="2014-02-18T07:32:18-05:00" itemprop="datePublished">Feb 18, 2014</time></p> <h1 class="post-title" itemprop="name headline">Searching a hash</h1> </header> <div class="post-content" itemprop="articleBody"> <p>Let’s say you have a list of stuff. You also have a tab delimited file with all of the items in your list (plus many more) with some other piece of information associated with each item. If you want to output the information from the tab delimited file associated with the items in your list you can use this script. I don’t think this would be very fast on large files (like those approaching 1 GB) the way it is currently coded.</p> <figure class="highlight"><pre><code class="language-ruby" data-lang="ruby"><span class="c1">#!/usr/bin/env ruby</span>
<span class="n">tab</span><span class="o">-</span><span class="n">delimited</span><span class="o">-</span><span class="n">mapping</span> <span class="o">=</span> <span class="no">ARGV</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">list</span> <span class="o">=</span> <span class="no">ARGV</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<span class="n">list_array</span> <span class="o">=</span> <span class="p">[]</span>
<span class="no">File</span><span class="p">.</span><span class="nf">new</span><span class="p">(</span><span class="n">list</span><span class="p">,</span> <span class="s1">'r'</span><span class="p">).</span><span class="nf">each</span> <span class="p">{</span> <span class="o">|</span><span class="n">line</span><span class="o">|</span> <span class="n">list_array</span> <span class="o">&lt;&lt;</span> <span class="n">line</span><span class="p">.</span><span class="nf">chop</span> <span class="p">}</span>
<span class="n">map</span> <span class="o">=</span> <span class="no">Hash</span><span class="p">.</span><span class="nf">new</span>
<span class="no">File</span><span class="p">.</span><span class="nf">open</span><span class="p">(</span><span class="n">tab</span><span class="o">-</span><span class="n">delimited</span><span class="o">-</span><span class="n">mapping</span><span class="p">).</span><span class="nf">each</span> <span class="k">do</span> <span class="o">|</span><span class="n">field</span><span class="o">|</span>
  <span class="n">cols</span> <span class="o">=</span> <span class="n">field</span><span class="p">.</span><span class="nf">chomp</span><span class="p">.</span><span class="nf">split</span><span class="p">(</span><span class="s2">"</span><span class="se">\t</span><span class="s2">"</span><span class="p">)</span>
  <span class="n">map</span><span class="p">[</span><span class="n">cols</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span> <span class="o">=</span> <span class="n">cols</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> 
<span class="k">end</span>
<span class="no">File</span><span class="p">.</span><span class="nf">open</span><span class="p">(</span><span class="n">list</span><span class="o">+</span><span class="s1">'_sub'</span><span class="p">,</span> <span class="s1">'w'</span><span class="p">)</span> <span class="k">do</span> <span class="o">|</span><span class="n">f</span><span class="o">|</span>
  <span class="n">list_array</span><span class="p">.</span><span class="nf">each</span> <span class="k">do</span> <span class="o">|</span><span class="n">entry</span><span class="o">|</span>
    <span class="k">if</span> <span class="n">maps</span><span class="p">.</span><span class="nf">has_key?</span><span class="p">(</span><span class="n">entry</span><span class="p">)</span>
      <span class="n">f</span><span class="p">.</span><span class="nf">puts</span> <span class="n">maps</span><span class="p">.</span><span class="nf">fetch</span><span class="p">(</span><span class="n">entry</span><span class="p">)</span>
    <span class="k">else</span>
      <span class="n">f</span><span class="p">.</span><span class="nf">puts</span> <span class="s2">"not found"</span>
    <span class="k">end</span>
  <span class="k">end</span>
<span class="k">end</span></code></pre></figure> <aside class="share"> <p>Share this post on <a href="http://twitter.com/share?text=Searching a hash&amp;url=//2014/searching-a-hash/&amp;via=slhogle" onclick="window.open(this.href, 'twitter-share', 'width=550,height=235');return false;">Twitter <i class="fa fa-twitter" aria-hidden="true" style="color:#00aced"></i></a> </p> </aside> </div> </article> <aside id="comments" class="disqus"> <div class="container"> <h3><i class="icon icon-comments-o"></i> Comments</h3> <div id="disqus_thread"></div> <script type="text/javascript"> var disqus_shortname = 'slhogle-site'; var disqus_identifier = '/2014/searching-a-hash'; var disqus_title = 'Searching a hash'; var disqus_url = '/'; /*var disqus_developer = 1;*/ (function() { var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true; dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js'; (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq); })(); </script> <noscript> Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript" rel="nofollow">comments powered by Disqus.</a> </noscript> </div> </aside> <footer class="site-footer"> <div class="container"> <div align="center"> <small class="block">&copy; 2016 Shane Hogle. All rights reserved.</small> </div> </div> </footer> </main> </body> </html>
