<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Shane Hogle</title>

    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="viewport" content="width=device-width,initial-scale=1">


    <link href="/css/styles.css" rel="stylesheet" type="text/css">
    <link href="/css/pygments.css" rel="stylesheet" type="text/css">
</head>
<body>
  <div class="sidebar">

<a> <img src="/img/shane.jpg" alt="me" width="300"> </a>

    <ul class="nav">
      <div class="nav-inner">
        <li><a href="/"><span class="icon doc"></span>blog</a></li>
        <li><a href="/about"><span class="icon info"></span>about</a></li>
        <li><a href="/projects"><span class="icon code"></span>projects</a></li>
        <li><a href="https://impactstory.org/ShaneHogle"><span class="icon impact"></span>impact story</a></li>
        <li><a href="http://twitter.com/slhogle"><span class="icon twitter"></span>twitter</a></li>
      </div>
    </ul>
  </div>
  <div class="wrapper">
    <!--<h1><marquee scrolldelay="60">otter pop - the world's greatest jekyll theme</marquee></h1>-->
    <h1>Output sequences from a fasta formatted file that match a list of sequence IDs</h1>

    <div class="post-body">
      <p>You need <a title="bioruby" href="http://bioruby.org/" target="_blank">bioruby</a> for this one. Bioruby is quite easy to install on unix systems. I use Ubuntu...</p>

<div class="highlight"><pre><code class="ruby"><span class="c1">#!/usr/bin/env ruby</span>
<span class="nb">require</span> <span class="s1">&#39;bio&#39;</span>
<span class="kp">include</span> <span class="no">Bio</span>
<span class="n">usage</span> <span class="o">=</span> <span class="o">&lt;&lt;</span> <span class="no">USAGE</span>
<span class="c1">######################################################################</span>
<span class="ss">Usage</span><span class="p">:</span> <span class="n">fasta_extracta</span><span class="o">.</span><span class="n">rb</span> <span class="n">seqlist</span><span class="o">.</span><span class="n">txt</span> <span class="n">fasta_infile</span><span class="o">.</span><span class="n">fasta</span>
<span class="no">Output</span> <span class="n">all</span> <span class="n">sequences</span> <span class="n">from</span> <span class="n">file</span> <span class="n">fasta_infile</span><span class="o">.</span><span class="n">fasta</span>
<span class="n">with</span> <span class="n">ids</span> <span class="n">matching</span> <span class="n">those</span> <span class="k">in</span> <span class="n">seqlist</span><span class="o">.</span><span class="n">txt</span> <span class="n">file</span> <span class="p">(</span><span class="n">one</span> <span class="n">entry</span> <span class="n">per</span> <span class="n">line</span><span class="p">)</span>
<span class="c1">######################################################################</span>
<span class="no">USAGE</span>
<span class="k">if</span> <span class="no">ARGV</span><span class="o">.</span><span class="n">size</span> <span class="o">==</span> <span class="mi">0</span>
  <span class="nb">print</span> <span class="n">usage</span>
	<span class="nb">exit</span> <span class="mi">1</span>
<span class="k">end</span>
<span class="n">id_file</span> <span class="o">=</span> <span class="no">ARGV</span><span class="o">[</span><span class="mi">0</span><span class="o">]</span>
<span class="n">seq_file</span> <span class="o">=</span> <span class="no">ARGV</span><span class="o">[</span><span class="mi">1</span><span class="o">]</span>
<span class="n">ids</span> <span class="o">=</span> <span class="nb">Array</span><span class="o">.</span><span class="n">new</span>
<span class="no">File</span><span class="o">.</span><span class="n">new</span><span class="p">(</span><span class="n">id_file</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">each</span> <span class="p">{</span> <span class="o">|</span><span class="n">line</span><span class="o">|</span> <span class="n">ids</span> <span class="o">&amp;</span><span class="n">lt</span><span class="p">;</span><span class="o">&amp;</span><span class="n">lt</span><span class="p">;</span> <span class="n">line</span><span class="o">.</span><span class="n">chop</span> <span class="p">}</span>
<span class="no">File</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">id_file</span><span class="o">+</span><span class="s1">&#39;_fasta_extracted&#39;</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">)</span> <span class="k">do</span> <span class="o">|</span><span class="n">file</span><span class="o">|</span>
  <span class="no">Bio</span><span class="o">::</span><span class="no">FlatFile</span><span class="o">.</span><span class="n">auto</span><span class="p">(</span><span class="n">seq_file</span><span class="p">)</span><span class="o">.</span><span class="n">each</span> <span class="k">do</span> <span class="o">|</span><span class="n">item</span><span class="o">|</span>
    <span class="n">ids</span><span class="o">.</span><span class="n">each</span> <span class="k">do</span> <span class="o">|</span><span class="nb">id</span><span class="o">|</span>
      <span class="k">if</span> <span class="n">item</span><span class="o">.</span><span class="n">definition</span> <span class="o">=~</span> <span class="sr">/</span><span class="si">#{</span><span class="nb">id</span><span class="si">}</span><span class="sr">/</span>
        <span class="n">seq</span> <span class="o">=</span> <span class="no">Bio</span><span class="o">::</span><span class="no">FastaFormat</span><span class="o">.</span><span class="n">new</span><span class="p">(</span><span class="s1">&#39;&gt; &#39;</span><span class="o">+</span><span class="n">item</span><span class="o">.</span><span class="n">definition</span><span class="o">+</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">+</span><span class="n">item</span><span class="o">.</span><span class="n">data</span><span class="p">)</span>
        <span class="n">file</span><span class="o">.</span><span class="n">puts</span> <span class="n">seq</span>
      <span class="k">end</span>
    <span class="k">end</span>
  <span class="k">end</span>
<span class="k">end</span></code></pre></div>

    </div>
  </div>
</body>
</html>
