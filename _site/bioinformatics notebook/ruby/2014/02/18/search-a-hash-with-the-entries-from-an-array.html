<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Shane Hogle</title>

    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="viewport" content="width=device-width,initial-scale=1">


    <link href="/css/styles.css" rel="stylesheet" type="text/css">
    <link href="/css/pygments.css" rel="stylesheet" type="text/css">
</head>
<body>
  <div class="sidebar">

<a> <img src="/img/shane.jpg" alt="me" width="300"> </a>

    <ul class="nav">
      <div class="nav-inner">
        <li><a href="/"><span class="icon doc"></span>blog</a></li>
        <li><a href="/about"><span class="icon info"></span>about</a></li>
        <li><a href="/projects"><span class="icon code"></span>projects</a></li>
        <li><a href="https://impactstory.org/ShaneHogle"><span class="icon impact"></span>impact story</a></li>
        <li><a href="http://twitter.com/slhogle"><span class="icon twitter"></span>twitter</a></li>
      </div>
    </ul>
  </div>
  <div class="wrapper">
    <!--<h1><marquee scrolldelay="60">otter pop - the world's greatest jekyll theme</marquee></h1>-->
    <h1>Search a hash with the entries from an array</h1>

    <div class="post-body">
      <p>Sooo... lets say you have a list of schtuff.  You also have a tab delimited file with all of the items in your list (plus many more) with some other piece of information associated with each item. If you want to output the information from the tab delimited file associated with the items in your list you can use this script. I don't think this would be very fast on large files (like those approaching 1 GB) the way it is currently coded.</p>

<div class="highlight"><pre><code class="ruby"><span class="c1">#!/usr/bin/env ruby</span>
<span class="c1">#input is two text files</span>
<span class="c1">#reads tab delimited mapping file as hash and other input as array.</span>
<span class="c1">#searches for each array element as key in hash and returns resulting value.</span>
<span class="c1">#script.rb tab.delimited.file.name list.name</span>
<span class="n">mapping</span> <span class="o">=</span> <span class="no">ARGV</span><span class="o">[</span><span class="mi">0</span><span class="o">]</span>
<span class="n">tree_name</span> <span class="o">=</span> <span class="no">ARGV</span><span class="o">[</span><span class="mi">1</span><span class="o">]</span>
<span class="n">tree_array</span> <span class="o">=</span> <span class="o">[]</span>
<span class="no">File</span><span class="o">.</span><span class="n">new</span><span class="p">(</span><span class="n">tree_name</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">each</span> <span class="p">{</span> <span class="o">|</span><span class="n">line1</span><span class="o">|</span> <span class="n">tree_array</span> <span class="o">&gt;&gt;</span> <span class="n">line1</span><span class="o">.</span><span class="n">chop</span> <span class="p">}</span>
<span class="n">maps</span> <span class="o">=</span> <span class="no">Hash</span><span class="o">.</span><span class="n">new</span>
<span class="no">File</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">mapping</span><span class="p">)</span><span class="o">.</span><span class="n">each</span> <span class="k">do</span> <span class="o">|</span><span class="n">field</span><span class="o">|</span>
  <span class="n">cols</span> <span class="o">=</span> <span class="n">field</span><span class="o">.</span><span class="n">chomp</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\t</span><span class="s2">&quot;</span><span class="p">)</span>
  <span class="n">maps</span><span class="o">[</span><span class="n">cols</span><span class="o">[</span><span class="mi">1</span><span class="o">]]</span> <span class="o">=</span> <span class="n">cols</span><span class="o">[</span><span class="mi">0</span><span class="o">]</span> 
<span class="k">end</span>
<span class="no">File</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">tree_name</span><span class="o">+</span><span class="s1">&#39;_sub&#39;</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">)</span> <span class="k">do</span> <span class="o">|</span><span class="n">f</span><span class="o">|</span>
  <span class="n">tree_array</span><span class="o">.</span><span class="n">each</span> <span class="k">do</span> <span class="o">|</span><span class="n">tree</span><span class="o">|</span>
    <span class="k">if</span> <span class="n">maps</span><span class="o">.</span><span class="n">has_key?</span><span class="p">(</span><span class="n">tree</span><span class="p">)</span>
      <span class="n">f</span><span class="o">.</span><span class="n">puts</span> <span class="n">maps</span><span class="o">.</span><span class="n">fetch</span><span class="p">(</span><span class="n">tree</span><span class="p">)</span>
    <span class="k">else</span>
      <span class="n">f</span><span class="o">.</span><span class="n">puts</span> <span class="s2">&quot;not found&quot;</span>
    <span class="k">end</span>
  <span class="k">end</span>
<span class="k">end</span></code></pre></div>

    </div>
  </div>
</body>
</html>
